<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Daily Branch Checklist</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  padding: 20px;
}
form {
  background: #fff;
  max-width: 900px;
  margin: auto;
  padding: 20px;
  border-radius: 8px;
}
h2 {
  text-align: center;
}
.question {
  margin-top: 18px;
}
.options label {
  margin-right: 15px;
}
textarea {
  width: 100%;
  margin-top: 8px;
  display: none;
}
button {
  margin-top: 25px;
  width: 100%;
  padding: 12px;
  font-size: 16px;
  background: #007bff;
  color: #fff;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}
button:hover {
  background: #0056b3;
}
</style>
</head>

<body>

<h2>Daily Branch Checklist</h2>

<form id="checklistForm">

<label>Branch Name</label>
<input type="text" name="Branch Name" required><br><br>

<label>Name of Person</label>
<input type="text" name="Name of Person" required><br><br>

<!-- QUESTIONS -->

<script>
const questions = [
 "Branch opened on time?",
 "Water Dispenser working?",
 "Tea Coffee Machine working?",
 "HK person / Security Guard reported on time?",
 "Biometric machine working?",
 "Biometric door lock working?",
 "CCTV System is working?",
 "All AC is working?",
 "UPS is working?",
 "Any incident happened in branch?",
 "Washroom Checklist updated?",
 "Electricity bill submitted to admin?",
 "Leakage / Seepage / bad smell?"
];
</script>

<div id="questions"></div>

<button type="submit">Submit</button>
</form>

<script>
const container = document.getElementById("questions");

questions.forEach((q, i) => {
  const index = i + 1;
  container.innerHTML += `
    <div class="question">
      <strong>${index}) ${q}</strong><br>
      <label><input type="radio" name="Q${index}" value="Yes" required onchange="toggleRemark(${index}, false)"> Yes</label>
      <label><input type="radio" name="Q${index}" value="No" onchange="toggleRemark(${index}, true)"> No</label>
      ${index === 3 ? `<label><input type="radio" name="Q${index}" value="NA" onchange="toggleRemark(${index}, false)"> NA</label>` : ""}
      <textarea name="Remark${index}" id="remark${index}" placeholder="Please mention reason"></textarea>
    </div>
  `;
});

function toggleRemark(id, show) {
  const box = document.getElementById("remark" + id);
  box.style.display = show ? "block" : "none";
  box.required = show;
}

document.getElementById("checklistForm").addEventListener("submit", function(e) {
  e.preventDefault();

  const formData = new FormData(this);

  fetch("https://script.google.com/macros/s/AKfycbyRzHgu1dG_v_ckqv7lN19Fnq1kECnjINm43ncqfgeeON0WSCG2I4MJ_IMwWj5IkvSP/exec", {
    method: "POST",
    body: formData
  })
  .then(res => res.text())
  .then(() => {
    alert("✅ Data submitted successfully!");
    document.getElementById("checklistForm").reset();
    document.querySelectorAll("textarea").forEach(t => {
      t.style.display = "none";
      t.required = false;
    });
  })
  .catch(() => {
    alert("❌ Submission failed. Please try again.");
  });
});
</script>

</body>
</html>
